<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>SNAKE PRO</title>
<style>
body{
    margin:0;
    background:#000;
    color:#0f0;
    font-family:monospace;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
}
#menu,#gameBox{text-align:center}
canvas{
    background:#000;
    border:3px solid #0f0;
    box-shadow:0 0 20px #0f0;
}
button,select{
    background:#000;
    color:#0f0;
    border:2px solid #0f0;
    padding:8px 12px;
    margin:5px;
    cursor:pointer;
}
.hidden{display:none}
</style>
</head>
<body>

<div id="menu">
    <h1>üêç SNAKE PRO</h1>
    <p>üèÜ –†–µ–∫–æ—Ä–¥: <span id="best">0</span></p>
    <select id="skin">
        <option value="green">üü¢ –ö–ª–∞—Å—Å–∏–∫</option>
        <option value="neon">üíö –ù–µ–æ–Ω</option>
        <option value="rainbow">üåà –†–∞–¥—É–≥–∞</option>
    </select><br>
    <button onclick="start()">‚ñ∂ –°—Ç–∞—Ä—Ç</button>
</div>

<div id="gameBox" class="hidden">
    <p>
        –û—á–∫–∏: <span id="score">0</span> |
        –£—Ä–æ–≤–µ–Ω—å: <span id="level">1</span>
    </p>
    <canvas id="game" width="400" height="400"></canvas><br>
    <button onclick="backToMenu()">‚èπ –ú–µ–Ω—é</button>
</div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
const box=20;

let snake,food,dir,score,level,speed,loop,skin,obstacles=[];
let best=localStorage.getItem("best")||0;
document.getElementById("best").textContent=best;

document.addEventListener("keydown",e=>{
    if(e.key==="ArrowLeft"&&dir!=="RIGHT")dir="LEFT";
    if(e.key==="ArrowRight"&&dir!=="LEFT")dir="RIGHT";
    if(e.key==="ArrowUp"&&dir!=="DOWN")dir="UP";
    if(e.key==="ArrowDown"&&dir!=="UP")dir="DOWN";
});

function start(){
    document.getElementById("menu").classList.add("hidden");
    document.getElementById("gameBox").classList.remove("hidden");
    skin=document.getElementById("skin").value;
    snake=[{x:200,y:200}];
    dir="RIGHT";
    score=0;
    level=1;
    speed=120;
    obstacles=[];
    food=randomPos();
    clearInterval(loop);
    loop=setInterval(draw,speed);
}

function backToMenu(){
    clearInterval(loop);
    document.getElementById("menu").classList.remove("hidden");
    document.getElementById("gameBox").classList.add("hidden");
}

function randomPos(){
    return{
        x:Math.floor(Math.random()*20)*box,
        y:Math.floor(Math.random()*20)*box
    };
}

function snakeColor(i){
    if(skin==="green")return i? "#070":"#0f0";
    if(skin==="neon")return i? "#0ff":"#fff";
    if(skin==="rainbow")return `hsl(${i*40},100%,50%)`;
}

function draw(){
    ctx.clearRect(0,0,400,400);

    // obstacles
    ctx.fillStyle="#f00";
    obstacles.forEach(o=>ctx.fillRect(o.x,o.y,box,box));

    // snake
    snake.forEach((s,i)=>{
        ctx.fillStyle=snakeColor(i);
        ctx.fillRect(s.x,s.y,box,box);
    });

    // food
    ctx.fillStyle="yellow";
    ctx.fillRect(food.x,food.y,box,box);

    let head={...snake[0]};
    if(dir==="LEFT")head.x-=box;
    if(dir==="RIGHT")head.x+=box;
    if(dir==="UP")head.y-=box;
    if(dir==="DOWN")head.y+=box;

    // collision
    if(
        head.x<0||head.y<0||head.x>=400||head.y>=400||
        snake.some(s=>s.x===head.x&&s.y===head.y)||
        obstacles.some(o=>o.x===head.x&&o.y===head.y)
    ){
        if(score>best){
            best=score;
            localStorage.setItem("best",best);
        }
        alert("üíÄ GAME OVER");
        backToMenu();
        document.getElementById("best").textContent=best;
        return;
    }

    if(head.x===food.x&&head.y===food.y){
        score++;
        food=randomPos();
        if(score%5===0){
            level++;
            speed=Math.max(50,speed-10);
            obstacles.push(randomPos());
            clearInterval(loop);
            loop=setInterval(draw,speed);
        }
    }else snake.pop();

    snake.unshift(head);

    document.getElementById("score").textContent=score;
    document.getElementById("level").textContent=level;
}
</script>

</body>
</html>
